---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "ONTAP: Snapmirror Policy"
subcategory: "SnapMirror"
description: |-
  SnapmirrorPolicy resource
---

# Resource Snapmirror Policy

Create/Modify/Delete a snapmirror policy resource

### Related ONTAP commands
* snapmirror policy create
* snapmirror policy modify
* snapmirror policy delete

## Supported Platforms
* On-perm ONTAP system 9.6 or higher
* Amazon FSx for NetApp ONTAP

## Example Usage
```
# Create a basic snapmirror policy
resource "netapp-ontap_snapmirror_policy_resource" "snapmirror_policy_basic_async1" {
  # required to know which system to interface with
  cx_profile_name = "cluster4"
  name = "test_async_basic"
  svm_name = "testSVM"
}

# Create a basic sync type snapmirror policy
resource "netapp-ontap_snapmirror_policy_resource" "snapmirror_policy_basic_sync1" {
  # required to know which system to interface with
  cx_profile_name = "cluster4"
  name = "test_sync_basic"
  svm_name = "testSVM"
  type = "sync"
  sync_type = "sync"
}

# Create a async type snapmirror policy with retention rules
resource "netapp-ontap_snapmirror_policy_resource" "snapmirror_policy_async" {
  # required to know which system to interface with
  cx_profile_name = "cluster4"
  name = "test_async_retention"
  svm_name = "testSVM"
  type = "async"
  retention = [{
    label = "weekly"
    count = 2
  },
  {
    label = "daily",
    count = 7
  },
  {
    label = "newlabel1",
    count = 3
  }
  ]
}

# Create a sync type snapmirror policy with retntion a rule
resource "netapp-ontap_snapmirror_policy_resource" "snapmirror_policy_sync" {
  # required to know which system to interface with
  cx_profile_name = "cluster4"
  name = "test_sync_retention"
  svm_name = "testSVM"
  comment = "test comment"
  type = "sync"
  sync_type = "sync"
  retention = [{
    count = 1
    label = "weekly"
  }
  ]
}
```


<!-- schema generated by tfplugindocs -->
## Argument Reference

### Required

- `cx_profile_name` (String) Connection profile name
- `name` (String) SnapmirrorPolicy name
- `svm_name` (String) SnapmirrorPolicy svm name

### Optional

- `comment` (String) Comment associated with the policy.
- `copy_all_source_snapshots` (Boolean) Specifies that all the source Snapshot copies (including the one created by SnapMirror before the transfer begins) should be copied to the destination on a transfer.
- `copy_latest_source_snapshot` (Boolean) Specifies that the latest source Snapshot copy (created by SnapMirror before the transfer begins) should be copied to the destination on a transfer. 'Retention' properties cannot be specified along with this property. This is applicable only to async policies. Property can only be set to 'true'.
- `create_snapshot_on_source` (Boolean) Specifies that all the source Snapshot copies (including the one created by SnapMirror before the transfer begins) should be copied to the destination on a transfer.
- `identity_preservation` (String) Specifies which configuration of the source SVM is replicated to the destination SVM.
- `network_compression_enabled` (Boolean) Specifies whether network compression is enabled for transfers.
- `retention` (Attributes List) Rules for Snapshot copy retention. (see [below for nested schema](#nestedatt--retention))
- `sync_type` (String) SnapmirrorPolicy sync type. [sync, strict_sync, automated_failover]
- `transfer_schedule_name` (String) The schedule used to update asynchronous relationships.
- `type` (String) SnapmirrorPolicy type. [async, sync, continuous]

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedatt--retention"></a>
### Nested Schema for `retention`

Required:

- `label` (String) Snapshot copy label

Optional:

- `count` (Number) Number of Snapshot copies to be kept for retention.
- `creation_schedule_name` (String) Schedule used to create Snapshot copies on the destination for long term retention.
- `prefix` (String) Specifies the prefix for the Snapshot copy name to be created as per the schedule

## Import
This resource supports import, which allows you to import existing snapmirror policy into the state of this resource.
Import require a unique ID composed of the snapmirror policy name, svm name and connection profile, separated by a comma.

id = `name`,`svm_name`,`cx_profile_name`

### Terraform Import

For example
```shell
 terraform import netapp-ontap_snapmirror_policy_resource.example test_name,svm1,cluster5
```
!> The terraform import CLI command can only import resources into the state. Importing via the CLI does not generate configuration. If you want to generate the accompanying configuration for imported resources, use the import block instead.

### Terrafomr Import Block
This requires Terraform 1.5 or higher, and will auto create the configuration for you

First create the block
```terraform
import {
  to = netapp-ontap_snapmirror_policy_resource.snapmirror_policy_import
  id = "test_name,svm1,cluster4"
}
```
Next run, this will auto create the configuration for you
```shell
terraform plan -generate-config-out=generated.tf
```
This will generate a file called generated.tf, which will contain the configuration for the imported resource
```terraform
# __generated__ by Terraform
# Please review these resources and move them into your main configuration files.
# __generated__ by Terraform from "svm1_root,svm1,cluster4"
resource "netapp-ontap_snapmirror_policy_resource" "svm_import" {
  comment = "testing import"
  cx_profile_name = "cluster4"
  name = "testImport"
  copy_all_source_snapshots = false
  copy_latest_source_snapshot = false
  create_snapshot_on_source = false
  identity_preservation = full
  network_compression_enabled = false
  retention = [
    {
      count = 4
      creation_schedule_name = null
      label = hi
      prefix = null
    }
  ]
  svm_name = ansibleSVM
  sync_type = null
  transfer_schedule_name = null
  type = async
}
```
